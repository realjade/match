{% extends "settings/settings.html" %}
{% block title %}背书吧--个人设置{% endblock %}
{% block scripts %}
<script type="text/javascript">
    function vali_nickname(){
        var name = document.getElementsByName("nickname")[0].value;
        var email = document.getElementsByName("email")[0].value;
        var mobile = document.getElementsByName("mobile")[0].value;
        
        var namereg = /[^\u4e00-\u9fa5]/;
        var emailreg = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        var mobilereg = /^1[3|5|8][0-9]\d{8}$/;
        
        if(name.length<2||name.length>6||namereg.test(name)){
            document.getElementById("nameerror").style.display = 'block';
        }else if(!email&&!mobile){
            document.getElementById("emailerror").style.display = 'block';
        }else if(!emailreg.test(email)&&email){
            document.getElementById("emailerror2").style.display = 'block';
        }else if(!mobilereg.test(mobile)&&mobile){
            document.getElementById("mobileerror").style.display = 'block';
        }else{
            return true;
        }
        return false;
    }
</script>
{% endblock %}
{% block form %}
{% set courselist = ["语文","数学","英语", "科学", "美术", "体育", "思想品德", "其他"] %}
<form action="/settings/profile/" method="post" onsubmit="return vali_nickname()">
    <div class="frbox clearfix">
        <label>姓名：</label>
        <input type="text" name="nickname" value="{{ g.user.nickname }}" />
        <div class="left note">二至四个汉字</div>
    </div>
    <div id="nameerror" class="tips">
        <div class="alert error" >请输入真实有效的姓名（2-4个汉字）</div>
    </div>
    
    <div class="frbox clearfix">
        <label>邮箱：</label>
        <input type="text" name="email" value="{{ g.user.email }}" />
        <div class="left note">可作为账号登录</div>
    </div>
    <div id="emailerror" class="tips">
        <div class="alert error" >邮箱和手机不能全部为空</div>
    </div>
    <div id="emailerror2" class="tips">
        <div class="alert error" >邮箱格式不正确</div>
    </div>
    
    <div class="frbox clearfix">
        <label>手机：</label>
        <input type="text" name="mobile" value="{{ g.user.mobile }}" />
        <div class="left note">可作为账号登录</div>
    </div>
    <div id="mobileerror" class="tips">
        <div class="alert error" >手机格式不正确</div>
    </div>
    <div class="frbox clearfix">
        <label>住址：</label>
        <input type="text" name="address" value="{{ g.user.profile.get('address','') }}" />
        <div class="left note">目前家庭住址</div>
    </div>
    
    <div class="frbox clearfix">
        <label>座机：</label>
        <input type="text" name="line_phone" value="{{ g.user.profile.get('line_phone','') }}" />
        <div class="left note">可联系到您的座机</div>
    </div>
    
    <div class="frbox clearfix">
        <label>QQ：</label>
        <input type="text" name="qq" value="{{ g.user.profile.get('qq','') }}" />
    </div>
    
    {% if g.user.isteacher %}
    <div class="frbox clearfix">
        <label>科目：</label>
        <select name="course">
            {% for course in courselist %}
            <option {% if g.user.course==course %}selected{% endif %} value="{{ course }}">{{ course }}</option>
            {% endfor %}
        </select>
    </div>
    {% endif %}
    
    <div class="frbox clearfix">
        <label>介绍：</label>
        <textarea class="left" name="desc" cols="30" rows="5">{{ g.user.profile.get("desc","") }}</textarea>
        <div class="left note">对您自己的简短介绍</div>
    </div>
    
    <div class="btnbox">
        <input type="submit" class="btn" value="保存"/>
    </div>
</form>
{% endblock %}
